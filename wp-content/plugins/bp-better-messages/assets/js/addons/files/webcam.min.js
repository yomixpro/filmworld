/*! For license information please see webcam.min.js.LICENSE.txt */
"use strict";(this.webpackChunkBetterMessages=this.webpackChunkBetterMessages||[]).push([["node_modules_uppy_webcam_lib_index_js"],{10362:(e,t,n)=>{n(25276),n(27495),n(90906),e.exports=a,e.exports.isMobile=a,e.exports.default=a;var o=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,i=/CrOS/,r=/android|ipad|playbook|silk/i;function a(e){e||(e={});var t=e.ua;if(t||"undefined"==typeof navigator||(t=navigator.userAgent),t&&t.headers&&"string"==typeof t.headers["user-agent"]&&(t=t.headers["user-agent"]),"string"!=typeof t)return!1;var n=o.test(t)&&!i.test(t)||!!e.tablet&&r.test(t);return!n&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==t.indexOf("Macintosh")&&-1!==t.indexOf("Safari")&&(n=!0),n}},36480:(e,t,n)=>{n.d(t,{FK:()=>y,Ob:()=>B,XX:()=>z,_3:()=>m,fF:()=>i,h:()=>v,uA:()=>b,v2:()=>C});n(51629),n(25276),n(64346),n(44114),n(34782),n(15086),n(26910),n(54554),n(59089),n(23288),n(94170),n(62010),n(26099),n(3362),n(27495),n(90906),n(25440),n(48718),n(23500),n(76031);var o,i,r,a,s,c,u,l={},p=[],d=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,h=Array.isArray;function f(e,t){for(var n in t)e[n]=t[n];return e}function _(e){var t=e.parentNode;t&&t.removeChild(e)}function v(e,t,n){var i,r,a,s={};for(a in t)"key"==a?i=t[a]:"ref"==a?r=t[a]:s[a]=t[a];if(arguments.length>2&&(s.children=arguments.length>3?o.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)void 0===s[a]&&(s[a]=e.defaultProps[a]);return g(e,s,i,r,null)}function g(e,t,n,o,a){var s={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==a?++r:a,__i:-1,__u:0};return null==a&&null!=i.vnode&&i.vnode(s),s}function m(){return{current:null}}function y(e){return e.children}function b(e,t){this.props=e,this.context=t}function w(e,t){if(null==t)return e.__?w(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?w(e):null}function k(e,t,n){var o,r=e.__v,a=r.__e,s=e.__P;if(s)return(o=f({},r)).__v=r.__v+1,i.vnode&&i.vnode(o),I(s,o,r,e.__n,void 0!==s.ownerSVGElement,32&r.__u?[a]:null,t,null==a?w(r):a,!!(32&r.__u),n),o.__v=r.__v,o.__.__k[o.__i]=o,o.__d=void 0,o.__e!=a&&S(o),o}function S(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return S(e)}}function x(e){(!e.__d&&(e.__d=!0)&&a.push(e)&&!P.__r++||s!==i.debounceRendering)&&((s=i.debounceRendering)||c)(P)}function P(){var e,t,n,o=[],r=[];for(a.sort(u);e=a.shift();)e.__d&&(n=a.length,t=k(e,o,r)||t,0===n||a.length>n?(L(o,t,r),r.length=o.length=0,t=void 0,a.sort(u)):t&&i.__c&&i.__c(t,p));t&&L(o,t,r),P.__r=0}function O(e,t,n,o,i,r,a,s,c,u,d){var h,f,_,v,g,m=o&&o.__k||p,y=t.length;for(n.__d=c,A(n,t,m),c=n.__d,h=0;h<y;h++)null!=(_=n.__k[h])&&"boolean"!=typeof _&&"function"!=typeof _&&(f=-1===_.__i?l:m[_.__i]||l,_.__i=h,I(e,_,f,i,r,a,s,c,u,d),v=_.__e,_.ref&&f.ref!=_.ref&&(f.ref&&V(f.ref,null,_),d.push(_.ref,_.__c||v,_)),null==g&&null!=v&&(g=v),65536&_.__u||f.__k===_.__k?c=R(_,c,e):"function"==typeof _.type&&void 0!==_.__d?c=_.__d:v&&(c=v.nextSibling),_.__d=void 0,_.__u&=-196609);n.__d=c,n.__e=g}function A(e,t,n){var o,i,r,a,s,c=t.length,u=n.length,l=u,p=0;for(e.__k=[],o=0;o<c;o++)a=o+p,null!=(i=e.__k[o]=null==(i=t[o])||"boolean"==typeof i||"function"==typeof i?null:"string"==typeof i||"number"==typeof i||"bigint"==typeof i||i.constructor==String?g(null,i,null,null,null):h(i)?g(y,{children:i},null,null,null):void 0===i.constructor&&i.__b>0?g(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i)?(i.__=e,i.__b=e.__b+1,s=T(i,n,a,l),i.__i=s,r=null,-1!==s&&(l--,(r=n[s])&&(r.__u|=131072)),null==r||null===r.__v?(-1==s&&p--,"function"!=typeof i.type&&(i.__u|=65536)):s!==a&&(s===a+1?p++:s>a?l>c-a?p+=s-a:p--:s<a?s==a-1&&(p=s-a):p=0,s!==o+p&&(i.__u|=65536))):(r=n[a])&&null==r.key&&r.__e&&!(131072&r.__u)&&(r.__e==e.__d&&(e.__d=w(r)),W(r,r,!1),n[a]=null,l--);if(l)for(o=0;o<u;o++)null!=(r=n[o])&&!(131072&r.__u)&&(r.__e==e.__d&&(e.__d=w(r)),W(r,r))}function R(e,t,n){var o,i;if("function"==typeof e.type){for(o=e.__k,i=0;o&&i<o.length;i++)o[i]&&(o[i].__=e,t=R(o[i],t,n));return t}e.__e!=t&&(n.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8===t.nodeType);return t}function C(e,t){return t=t||[],null==e||"boolean"==typeof e||(h(e)?e.some((function(e){C(e,t)})):t.push(e)),t}function T(e,t,n,o){var i=e.key,r=e.type,a=n-1,s=n+1,c=t[n];if(null===c||c&&i==c.key&&r===c.type&&!(131072&c.__u))return n;if(o>(null==c||131072&c.__u?0:1))for(;a>=0||s<t.length;){if(a>=0){if((c=t[a])&&!(131072&c.__u)&&i==c.key&&r===c.type)return a;a--}if(s<t.length){if((c=t[s])&&!(131072&c.__u)&&i==c.key&&r===c.type)return s;s++}}return-1}function M(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||d.test(t)?n:n+"px"}function j(e,t,n,o,i){var r;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof o&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||M(e.style,t,"");if(n)for(t in n)o&&n[t]===o[t]||M(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])r=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?o?n.u=o.u:(n.u=Date.now(),e.addEventListener(t,r?E:D,r)):e.removeEventListener(t,r?E:D,r);else{if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==t&&"height"!==t&&"href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&"rowSpan"!==t&&"colSpan"!==t&&"role"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,n))}}function D(e){if(this.l){var t=this.l[e.type+!1];if(e.t){if(e.t<=t.u)return}else e.t=Date.now();return t(i.event?i.event(e):e)}}function E(e){if(this.l)return this.l[e.type+!0](i.event?i.event(e):e)}function I(e,t,n,o,r,a,s,c,u,l){var p,d,_,v,g,m,w,k,S,x,P,A,R,C,T,M=t.type;if(void 0!==t.constructor)return null;128&n.__u&&(u=!!(32&n.__u),a=[c=t.__e=n.__e]),(p=i.__b)&&p(t);e:if("function"==typeof M)try{if(k=t.props,S=(p=M.contextType)&&o[p.__c],x=p?S?S.props.value:p.__:o,n.__c?w=(d=t.__c=n.__c).__=d.__E:("prototype"in M&&M.prototype.render?t.__c=d=new M(k,x):(t.__c=d=new b(k,x),d.constructor=M,d.render=F),S&&S.sub(d),d.props=k,d.state||(d.state={}),d.context=x,d.__n=o,_=d.__d=!0,d.__h=[],d._sb=[]),null==d.__s&&(d.__s=d.state),null!=M.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=f({},d.__s)),f(d.__s,M.getDerivedStateFromProps(k,d.__s))),v=d.props,g=d.state,d.__v=t,_)null==M.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==M.getDerivedStateFromProps&&k!==v&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(k,x),!d.__e&&(null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(k,d.__s,x)||t.__v===n.__v)){for(t.__v!==n.__v&&(d.props=k,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),P=0;P<d._sb.length;P++)d.__h.push(d._sb[P]);d._sb=[],d.__h.length&&s.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(k,d.__s,x),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(v,g,m)}))}if(d.context=x,d.props=k,d.__P=e,d.__e=!1,A=i.__r,R=0,"prototype"in M&&M.prototype.render){for(d.state=d.__s,d.__d=!1,A&&A(t),p=d.render(d.props,d.state,d.context),C=0;C<d._sb.length;C++)d.__h.push(d._sb[C]);d._sb=[]}else do{d.__d=!1,A&&A(t),p=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++R<25);d.state=d.__s,null!=d.getChildContext&&(o=f(f({},o),d.getChildContext())),_||null==d.getSnapshotBeforeUpdate||(m=d.getSnapshotBeforeUpdate(v,g)),O(e,h(T=null!=p&&p.type===y&&null==p.key?p.props.children:p)?T:[T],t,n,o,r,a,s,c,u,l),d.base=t.__e,t.__u&=-161,d.__h.length&&s.push(d),w&&(d.__E=d.__=null)}catch(e){t.__v=null,u||null!=a?(t.__e=c,t.__u|=u?160:32,a[a.indexOf(c)]=null):(t.__e=n.__e,t.__k=n.__k),i.__e(e,t,n)}else null==a&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=N(n.__e,t,n,o,r,a,s,u,l);(p=i.diffed)&&p(t)}function L(e,t,n){for(var o=0;o<n.length;o++)V(n[o],n[++o],n[++o]);i.__c&&i.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){i.__e(e,t.__v)}}))}function N(e,t,n,i,r,a,s,c,u){var p,d,f,v,g,m,y,b=n.props,k=t.props,S=t.type;if("svg"===S&&(r=!0),null!=a)for(p=0;p<a.length;p++)if((g=a[p])&&"setAttribute"in g==!!S&&(S?g.localName===S:3===g.nodeType)){e=g,a[p]=null;break}if(null==e){if(null===S)return document.createTextNode(k);e=r?document.createElementNS("http://www.w3.org/2000/svg",S):document.createElement(S,k.is&&k),a=null,c=!1}if(null===S)b===k||c&&e.data===k||(e.data=k);else{if(a=a&&o.call(e.childNodes),b=n.props||l,!c&&null!=a)for(b={},p=0;p<e.attributes.length;p++)b[(g=e.attributes[p]).name]=g.value;for(p in b)g=b[p],"children"==p||("dangerouslySetInnerHTML"==p?f=g:"key"===p||p in k||j(e,p,null,g,r));for(p in k)g=k[p],"children"==p?v=g:"dangerouslySetInnerHTML"==p?d=g:"value"==p?m=g:"checked"==p?y=g:"key"===p||c&&"function"!=typeof g||b[p]===g||j(e,p,g,b[p],r);if(d)c||f&&(d.__html===f.__html||d.__html===e.innerHTML)||(e.innerHTML=d.__html),t.__k=[];else if(f&&(e.innerHTML=""),O(e,h(v)?v:[v],t,n,i,r&&"foreignObject"!==S,a,s,a?a[0]:n.__k&&w(n,0),c,u),null!=a)for(p=a.length;p--;)null!=a[p]&&_(a[p]);c||(p="value",void 0!==m&&(m!==e[p]||"progress"===S&&!m||"option"===S&&m!==b[p])&&j(e,p,m,b[p],!1),p="checked",void 0!==y&&y!==e[p]&&j(e,p,y,b[p],!1))}return e}function V(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){i.__e(e,n)}}function W(e,t,n){var o,r;if(i.unmount&&i.unmount(e),(o=e.ref)&&(o.current&&o.current!==e.__e||V(o,null,t)),null!=(o=e.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(e){i.__e(e,t)}o.base=o.__P=null,e.__c=void 0}if(o=e.__k)for(r=0;r<o.length;r++)o[r]&&W(o[r],t,n||"function"!=typeof e.type);n||null==e.__e||_(e.__e),e.__=e.__e=e.__d=void 0}function F(e,t,n){return this.constructor(e,n)}function z(e,t,n){var r,a,s,c;i.__&&i.__(e,t),a=(r="function"==typeof n)?null:n&&n.__k||t.__k,s=[],c=[],I(t,e=(!r&&n||t).__k=v(y,null,[e]),a||l,l,void 0!==t.ownerSVGElement,!r&&n?[n]:a?null:t.firstChild?o.call(t.childNodes):null,s,!r&&n?n:a?a.__e:t.firstChild,r,c),e.__d=void 0,L(s,e,c)}function B(e,t,n){var i,r,a,s,c=f({},e.props);for(a in e.type&&e.type.defaultProps&&(s=e.type.defaultProps),t)"key"==a?i=t[a]:"ref"==a?r=t[a]:c[a]=void 0===t[a]&&void 0!==s?s[a]:t[a];return arguments.length>2&&(c.children=arguments.length>3?o.call(arguments,2):n),g(e.type,c,i||e.key,r||e.ref,null)}o=p.slice,i={__e:function(e,t,n,o){for(var i,r,a;t=t.__;)if((i=t.__c)&&!i.__)try{if((r=i.constructor)&&null!=r.getDerivedStateFromError&&(i.setState(r.getDerivedStateFromError(e)),a=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,o||{}),a=i.__d),a)return i.__E=i}catch(t){e=t}throw e}},r=0,b.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=f({},this.state),"function"==typeof e&&(e=e(f({},n),this.props)),e&&f(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),x(this))},b.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),x(this))},b.prototype.render=y,a=[],c="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,u=function(e,t){return e.__v.__b-t.__v.__b},P.__r=0},83237:(e,t,n)=>{n(70511)("replace")},31073:(e,t,n)=>{n(70511)("split")},32744:(e,t,n)=>{n.d(t,{A:()=>u});n(52675),n(2008),n(51629),n(44114),n(67945),n(84185),n(83851),n(81278),n(79432),n(26099),n(23500);var o=n(51531),i=n(58237),r=n(84285),a=(n(16280),n(76918),n(94170),n(13656));function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=function(){function e(t,n){(0,i.A)(this,e),this.uppy=t,this.opts=null!=n?n:{}}return(0,r.A)(e,[{key:"getPluginState",value:function(){var e=this.uppy.getState().plugins;return(null==e?void 0:e[this.id])||{}}},{key:"setPluginState",value:function(e){if(e){var t=this.uppy.getState().plugins;this.uppy.setState({plugins:c(c({},t),{},(0,o.A)({},this.id,c(c({},t[this.id]),e)))})}}},{key:"setOptions",value:function(e){this.opts=c(c({},this.opts),e),this.setPluginState(void 0),this.i18nInit()}},{key:"i18nInit",value:function(){var e=new a.A([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}},{key:"addTarget",value:function(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}},{key:"install",value:function(){}},{key:"uninstall",value:function(){}},{key:"update",value:function(e){}},{key:"afterUpdate",value:function(){}}]),e}()},73848:(e,t,n)=>{n.d(t,{A:()=>w});var o=n(58237),i=n(84285),r=n(78158),a=n(36858),s=n(78241),c=n(31061),u=n(46983),l=(n(16280),n(76918),n(28706),n(84185),n(26099),n(3362),n(60825),n(15472),n(36480)),p=n(10826);const d=function(e,t){return void 0===t&&(t=document),"string"==typeof e?t.querySelector(e):(0,p.A)(e)?e:null};var h=n(36118),f=n(32744);function _(e,t,n){return t=(0,a.A)(t),(0,r.A)(e,v()?Reflect.construct(t,n||[],(0,a.A)(e).constructor):t.apply(e,n))}function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(v=function(){return!!e})()}function g(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var m=0;function y(e){return"__private_"+m+++"_"+e}var b=y("updateUI");const w=function(e){function t(){var e;return(0,o.A)(this,t),e=_(this,t,arguments),Object.defineProperty((0,s.A)(e),b,{writable:!0,value:void 0}),e}return(0,c.A)(t,e),(0,i.A)(t,[{key:"getTargetPlugin",value:function(e){var n;if("function"==typeof(null==e?void 0:e.addTarget))(n=e)instanceof t||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:n,UIPlugin:t}}));else if("function"==typeof e){var o=e;this.uppy.iteratePlugins((function(e){e instanceof o&&(n=e)}))}return n}},{key:"mount",value:function(e,t){var n,o,i,r=this,a=t.id,s=d(e);if(s){this.isTargetDOMEl=!0;var c=document.createElement("div");return c.classList.add("uppy-Root"),g(this,b)[b]=(n=function(e){r.uppy.getPlugin(r.id)&&((0,l.XX)(r.render(e),c),r.afterUpdate())},i=null,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o=t,i||(i=Promise.resolve().then((function(){return i=null,n.apply(void 0,(0,u.A)(o))}))),i}),this.uppy.log("Installing ".concat(a," to a DOM element '").concat(e,"'")),this.opts.replaceTargetContent&&(s.innerHTML=""),(0,l.XX)(this.render(this.uppy.getState()),c),this.el=c,s.appendChild(c),c.dir=this.opts.direction||(0,h.A)(c)||"ltr",this.onMount(),this.el}var p=this.getTargetPlugin(e);if(p)return this.uppy.log("Installing ".concat(a," to ").concat(p.id)),this.parent=p,this.el=p.addTarget(t),this.onMount(),this.el;this.uppy.log("Not installing ".concat(a));var f="Invalid target option given to ".concat(a,".");throw f+="function"==typeof e?" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":"If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(f)}},{key:"render",value:function(e){throw new Error("Extend the render method to add your plugin to a DOM element")}},{key:"update",value:function(e){var t,n;null!=this.el&&(null==(t=(n=g(this,b))[b])||t.call(n,e))}},{key:"unmount",value:function(){var e;this.isTargetDOMEl&&(null==(e=this.el)||e.remove());this.onUnmount()}},{key:"onMount",value:function(){}},{key:"onUnmount",value:function(){}}]),t}(f.A)},13656:(e,t,n)=>{n.d(t,{A:()=>g});var o=n(51531),i=n(18180),r=n(58237),a=n(84285);n(52675),n(89463),n(83237),n(31073),n(16280),n(76918),n(2008),n(51629),n(64346),n(48598),n(44114),n(69085),n(67945),n(84185),n(83851),n(81278),n(79432),n(26099),n(84864),n(57465),n(27495),n(87745),n(38781),n(25440),n(90744),n(23500);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var l=0;function p(e){return"__private_"+l+++"_"+e}function d(e,t,n){var o=[];return e.forEach((function(e){return"string"!=typeof e?o.push(e):t[Symbol.split](e).forEach((function(e,t,i){""!==e&&o.push(e),t<i.length-1&&o.push(n)}))})),o}function h(e,t){var n=/\$/g,o=[e];if(null==t)return o;for(var i=0,r=Object.keys(t);i<r.length;i++){var a=r[i];if("_"!==a){var s=t[a];"string"==typeof s&&(s=n[Symbol.replace](s,"$$$$")),o=d(o,new RegExp("%\\{".concat(a,"\\}"),"g"),s)}}return o}var f=function(e){throw new Error("missing string: ".concat(e))},_=p("onMissingKey"),v=p("apply"),g=function(){function e(t,n){(0,r.A)(this,e);var o=(void 0===n?{}:n).onMissingKey,i=void 0===o?f:o;Object.defineProperty(this,v,{value:m}),Object.defineProperty(this,_,{writable:!0,value:void 0}),this.locale={strings:{},pluralize:function(e){return 1===e?0:1}},Array.isArray(t)?t.forEach(u(this,v)[v],this):u(this,v)[v](t),u(this,_)[_]=i}return(0,a.A)(e,[{key:"translate",value:function(e,t){return this.translateArray(e,t).join("")}},{key:"translateArray",value:function(e,t){var n=this.locale.strings[e];if(null==n&&(u(this,_)[_](e),n=e),"object"===(0,i.A)(n)){if(t&&void 0!==t.smart_count)return h(n[this.locale.pluralize(t.smart_count)],t);throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if("string"!=typeof n)throw new Error("string was not a string");return h(n,t)}}]),e}();function m(e){if(null!=e&&e.strings){var t=this.locale;Object.assign(this.locale,{strings:c(c({},t.strings),e.strings),pluralize:e.pluralize||t.pluralize})}}},36118:(e,t,n)=>{n.d(t,{A:()=>o});const o=function(e){for(var t;e&&!e.dir;)e=e.parentNode;return null==(t=e)?void 0:t.dir}},10826:(e,t,n)=>{n.d(t,{A:()=>i});var o=n(18180);function i(e){return"object"===(0,o.A)(e)&&null!==e&&("nodeType"in e&&e.nodeType===Node.ELEMENT_NODE)}},63265:(e,t,n)=>{n.d(t,{A:()=>o});const o={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"}},73886:(e,t,n)=>{n.r(t),n.d(t,{default:()=>X});var o=n(18180),i=n(18443),r=n(51531),a=n(58237),s=n(84285),c=n(78158),u=n(78241),l=n(20423),p=n(36858),d=n(31061),h=n(61792),f=(n(52675),n(16280),n(76918),n(28706),n(2008),n(50113),n(51629),n(74423),n(25276),n(23792),n(62062),n(44114),n(72712),n(34782),n(15086),n(59089),n(23288),n(94170),n(69085),n(67945),n(84185),n(83851),n(81278),n(79432),n(26099),n(3362),n(60825),n(15472),n(27495),n(90906),n(21699),n(47764),n(71761),n(23500),n(62953),n(76031),n(3296),n(48408),n(36480)),_=n(73848),v=n(80241),g={__proto__:null,"audio/mp3":"mp3","audio/mp4":"mp4","audio/ogg":"ogg","audio/webm":"webm","image/gif":"gif","image/heic":"heic","image/heif":"heif","image/jpeg":"jpg","image/png":"png","image/svg+xml":"svg","video/mp4":"mp4","video/ogg":"ogv","video/quicktime":"mov","video/webm":"webm","video/x-matroska":"mkv","video/x-msvideo":"avi"};function m(e){var t=e.split(";",1);return e=(0,v.A)(t,1)[0],g[e]||null}var y=n(63265),b=n(10362);const w=function(){return(0,f.h)("svg",{"aria-hidden":"true",focusable:"false",fill:"#0097DC",width:"66",height:"55",viewBox:"0 0 66 55"},(0,f.h)("path",{d:"M57.3 8.433c4.59 0 8.1 3.51 8.1 8.1v29.7c0 4.59-3.51 8.1-8.1 8.1H8.7c-4.59 0-8.1-3.51-8.1-8.1v-29.7c0-4.59 3.51-8.1 8.1-8.1h9.45l4.59-7.02c.54-.54 1.35-1.08 2.16-1.08h16.2c.81 0 1.62.54 2.16 1.08l4.59 7.02h9.45zM33 14.64c-8.62 0-15.393 6.773-15.393 15.393 0 8.62 6.773 15.393 15.393 15.393 8.62 0 15.393-6.773 15.393-15.393 0-8.62-6.773-15.393-15.393-15.393zM33 40c-5.648 0-9.966-4.319-9.966-9.967 0-5.647 4.318-9.966 9.966-9.966s9.966 4.319 9.966 9.966C42.966 35.681 38.648 40 33 40z",fillRule:"evenodd"}))},k=function(e){var t=e.onSnapshot,n=e.i18n;return(0,f.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--picture",type:"button",title:n("takePicture"),"aria-label":n("takePicture"),onClick:t,"data-uppy-super-focusable":!0},w())};function S(e){var t=e.recording,n=e.onStartRecording,o=e.onStopRecording,i=e.i18n;return t?(0,f.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button",type:"button",title:i("stopRecording"),"aria-label":i("stopRecording"),onClick:o,"data-uppy-super-focusable":!0},(0,f.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100"},(0,f.h)("rect",{x:"15",y:"15",width:"70",height:"70"}))):(0,f.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button",type:"button",title:i("startRecording"),"aria-label":i("startRecording"),onClick:n,"data-uppy-super-focusable":!0},(0,f.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100"},(0,f.h)("circle",{cx:"50",cy:"50",r:"40"})))}n(68156);function x(e){var t,n=e.recordingLengthSeconds,o=e.i18n,i=(t=n,"".concat(Math.floor(t/60),":").concat(String(t%60).padStart(2,0)));return(0,f.h)("span",{"aria-label":o("recordingLength",{recording_length:i})},i)}const P=function(e){var t=e.onSubmit,n=e.i18n;return(0,f.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--submit",type:"button",title:n("submitRecordedFile"),"aria-label":n("submitRecordedFile"),onClick:t,"data-uppy-super-focusable":!0},(0,f.h)("svg",{width:"12",height:"9",viewBox:"0 0 12 9",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",className:"uppy-c-icon"},(0,f.h)("path",{fill:"#fff",fillRule:"nonzero",d:"M10.66 0L12 1.31 4.136 9 0 4.956l1.34-1.31L4.136 6.38z"})))};const O=function(e){var t=e.onDiscard,n=e.i18n;return(0,f.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--discard",type:"button",title:n("discardRecordedFile"),"aria-label":n("discardRecordedFile"),onClick:t,"data-uppy-super-focusable":!0},(0,f.h)("svg",{width:"13",height:"13",viewBox:"0 0 13 13",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",className:"uppy-c-icon"},(0,f.h)("g",{fill:"#FFF",fillRule:"evenodd"},(0,f.h)("path",{d:"M.496 11.367L11.103.76l1.414 1.414L1.911 12.781z"}),(0,f.h)("path",{d:"M11.104 12.782L.497 2.175 1.911.76l10.607 10.606z"}))))};function A(e,t,n){return t=(0,p.A)(t),(0,c.A)(e,R()?Reflect.construct(t,n||[],(0,p.A)(e).constructor):t.apply(e,n))}function R(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(R=function(){return!!e})()}function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},C.apply(this,arguments)}function T(e,t){return e.includes(t)}const M=function(e){function t(){return(0,a.A)(this,t),A(this,t,arguments)}return(0,d.A)(t,e),(0,s.A)(t,[{key:"componentDidMount",value:function(){(0,this.props.onFocus)()}},{key:"componentWillUnmount",value:function(){(0,this.props.onStop)()}},{key:"render",value:function(){var e=this,t=this.props,n=t.src,o=t.recordedVideo,i=t.recording,r=t.modes,a=t.supportsRecording,s=t.videoSources,c=t.showVideoSourceDropdown,u=t.showRecordingLength,l=t.onSubmit,p=t.i18n,d=t.mirror,h=t.onSnapshot,_=t.onStartRecording,v=t.onStopRecording,g=t.onDiscardRecordedVideo,m=t.recordingLengthSeconds,y=!!o,b=!y&&a&&(T(r,"video-only")||T(r,"audio-only")||T(r,"video-audio")),w=!y&&T(r,"picture"),A=a&&u&&!y,R=c&&s&&s.length>1,M={playsinline:!0};return o?(M.muted=!1,M.controls=!0,M.src=o,this.videoElement&&(this.videoElement.srcObject=void 0)):(M.muted=!0,M.autoplay=!0,M.srcObject=n),(0,f.h)("div",{className:"uppy uppy-Webcam-container"},(0,f.h)("div",{className:"uppy-Webcam-videoContainer"},(0,f.h)("video",C({ref:function(t){return e.videoElement=t},className:"uppy-Webcam-video  ".concat(d?"uppy-Webcam-video--mirrored":"")},M))),(0,f.h)("div",{className:"uppy-Webcam-footer"},(0,f.h)("div",{className:"uppy-Webcam-videoSourceContainer"},R?function(e){var t=e.currentDeviceId,n=e.videoSources,o=e.onChangeVideoSource;return(0,f.h)("div",{className:"uppy-Webcam-videoSource"},(0,f.h)("select",{className:"uppy-u-reset uppy-Webcam-videoSource-select",onChange:function(e){o(e.target.value)}},n.map((function(e){return(0,f.h)("option",{key:e.deviceId,value:e.deviceId,selected:e.deviceId===t},e.label)}))))}(this.props):null),(0,f.h)("div",{className:"uppy-Webcam-buttonContainer"},w&&(0,f.h)(k,{onSnapshot:h,i18n:p}),b&&(0,f.h)(S,{recording:i,onStartRecording:_,onStopRecording:v,i18n:p}),y&&(0,f.h)(P,{onSubmit:l,i18n:p}),y&&(0,f.h)(O,{onDiscard:g,i18n:p})),(0,f.h)("div",{className:"uppy-Webcam-recordingLength"},A&&(0,f.h)(x,{recordingLengthSeconds:m,i18n:p}))))}}]),t}(f.uA),j=function(e){var t=e.icon,n=e.i18n,o=e.hasCamera;return(0,f.h)("div",{className:"uppy-Webcam-permissons"},(0,f.h)("div",{className:"uppy-Webcam-permissonsIcon"},t()),(0,f.h)("h1",{className:"uppy-Webcam-title"},n(o?"allowAccessTitle":"noCameraTitle")),(0,f.h)("p",null,n(o?"allowAccessDescription":"noCameraDescription")))},D={strings:{pluginNameCamera:"Camera",noCameraTitle:"Camera Not Available",noCameraDescription:"In order to take pictures or record video, please connect a camera device",recordingStoppedMaxSize:"Recording stopped because the file size is about to exceed the limit",submitRecordedFile:"Submit recorded file",discardRecordedFile:"Discard recorded file",smile:"Smile!",takePicture:"Take a picture",startRecording:"Begin video recording",stopRecording:"Stop video recording",recordingLength:"Recording length %{recording_length}",allowAccessTitle:"Please allow access to your camera",allowAccessDescription:"In order to take pictures or record video with your camera, please allow camera access for this site."}};function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){return t=(0,p.A)(t),(0,c.A)(e,N()?Reflect.construct(t,n||[],(0,p.A)(e).constructor):t.apply(e,n))}function N(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(N=function(){return!!e})()}function V(){return V=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},V.apply(this,arguments)}function W(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var F=0;function z(e){return"__private_"+F+++"_"+e}function B(e){return"."===e[0]?y.A[e.slice(1)]:e}function U(e){return/^video\/[^*]+$/.test(e)}function $(e){return/^image\/[^*]+$/.test(e)}function H(e,t){return e.includes(t)}var q=z("enableMirror"),X=function(e){function t(e,n){var o;(0,a.A)(this,t),o=L(this,t,[e,n]),Object.defineProperty((0,u.A)(o),q,{writable:!0,value:void 0}),o.mediaDevices=navigator.mediaDevices,o.supportsUserMedia=!!o.mediaDevices,o.protocol=location.protocol.match(/https/i)?"https":"http",o.id=o.opts.id||"Webcam",o.type="acquirer",o.capturedMediaFile=null,o.icon=function(){return(0,f.h)("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},(0,f.h)("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383",fillRule:"nonzero"}))},o.defaultLocale=D;var i={onBeforeSnapshot:function(){return Promise.resolve()},countdown:!1,modes:["video-audio","video-only","audio-only","picture"],mirror:!0,showVideoSourceDropdown:!1,facingMode:"user",videoConstraints:void 0,preferredImageMimeType:null,preferredVideoMimeType:null,showRecordingLength:!1,mobileNativeCamera:b({tablet:!0})};return o.opts=I(I({},i),n),o.i18nInit(),o.title=o.i18n("pluginNameCamera"),W((0,u.A)(o),q)[q]=o.opts.mirror,o.install=o.install.bind((0,u.A)(o)),o.setPluginState=o.setPluginState.bind((0,u.A)(o)),o.render=o.render.bind((0,u.A)(o)),o.start=o.start.bind((0,u.A)(o)),o.stop=o.stop.bind((0,u.A)(o)),o.takeSnapshot=o.takeSnapshot.bind((0,u.A)(o)),o.startRecording=o.startRecording.bind((0,u.A)(o)),o.stopRecording=o.stopRecording.bind((0,u.A)(o)),o.discardRecordedVideo=o.discardRecordedVideo.bind((0,u.A)(o)),o.submit=o.submit.bind((0,u.A)(o)),o.oneTwoThreeSmile=o.oneTwoThreeSmile.bind((0,u.A)(o)),o.focus=o.focus.bind((0,u.A)(o)),o.changeVideoSource=o.changeVideoSource.bind((0,u.A)(o)),o.webcamActive=!1,o.opts.countdown&&(o.opts.onBeforeSnapshot=o.oneTwoThreeSmile),o.setPluginState({hasCamera:!1,cameraReady:!1,cameraError:null,recordingLengthSeconds:0,videoSources:[],currentDeviceId:null}),o}var n;return(0,d.A)(t,e),(0,s.A)(t,[{key:"setOptions",value:function(e){(0,l.A)((0,p.A)(t.prototype),"setOptions",this).call(this,I(I({},e),{},{videoConstraints:I(I({},this.opts.videoConstraints),null==e?void 0:e.videoConstraints)}))}},{key:"hasCameraCheck",value:function(){return this.mediaDevices?this.mediaDevices.enumerateDevices().then((function(e){return e.some((function(e){return"videoinput"===e.kind}))})):Promise.resolve(!1)}},{key:"isAudioOnly",value:function(){return 1===this.opts.modes.length&&"audio-only"===this.opts.modes[0]}},{key:"getConstraints",value:function(e){void 0===e&&(e=null);var t=-1!==this.opts.modes.indexOf("video-audio")||-1!==this.opts.modes.indexOf("audio-only"),n=!this.isAudioOnly()&&(-1!==this.opts.modes.indexOf("video-audio")||-1!==this.opts.modes.indexOf("video-only")||-1!==this.opts.modes.indexOf("picture")),o=I(I({},this.opts.videoConstraints||{facingMode:this.opts.facingMode}),e?{deviceId:e,facingMode:null}:{});return{audio:t,video:!!n&&o}}},{key:"start",value:function(e){var t=this;if(void 0===e&&(e=null),!this.supportsUserMedia)return Promise.reject(new Error("Webcam access not supported"));this.webcamActive=!0,this.opts.mirror&&(W(this,q)[q]=!0);var n=this.getConstraints(e&&e.deviceId?e.deviceId:null);this.hasCameraCheck().then((function(o){return t.setPluginState({hasCamera:o}),t.mediaDevices.getUserMedia(n).then((function(n){t.stream=n;var o=null,i=t.isAudioOnly()?n.getAudioTracks():n.getVideoTracks();e&&e.deviceId?i.forEach((function(t){t.getSettings().deviceId===e.deviceId&&(o=t.getSettings().deviceId)})):o=i[0].getSettings().deviceId,t.updateVideoSources(),t.setPluginState({currentDeviceId:o,cameraReady:!0})})).catch((function(e){t.setPluginState({cameraReady:!1,cameraError:e}),t.uppy.info(e.message,"error")}))}))}},{key:"getMediaRecorderOptions",value:function(){var e={};if(MediaRecorder.isTypeSupported){var t=this.uppy.opts.restrictions,n=[];this.opts.preferredVideoMimeType?n=[this.opts.preferredVideoMimeType]:t.allowedFileTypes&&(n=t.allowedFileTypes.map(B).filter(U));var o=n.filter((function(e){return MediaRecorder.isTypeSupported(e)&&m(e)}));o.length>0&&(e.mimeType=o[0])}return e}},{key:"startRecording",value:function(){var e=this;this.recorder=new MediaRecorder(this.stream,this.getMediaRecorderOptions()),this.recordingChunks=[];var t=!1;this.recorder.addEventListener("dataavailable",(function(n){e.recordingChunks.push(n.data);var o=e.uppy.opts.restrictions;if(e.recordingChunks.length>1&&null!=o.maxFileSize&&!t){var i=e.recordingChunks.reduce((function(e,t){return e+t.size}),0),r=3*((i-e.recordingChunks[0].size)/(e.recordingChunks.length-1));i>Math.max(0,o.maxFileSize-r)&&(t=!0,e.uppy.info(e.i18n("recordingStoppedMaxSize"),"warning",4e3),e.stopRecording())}})),this.recorder.start(500),this.opts.showRecordingLength&&(this.recordingLengthTimer=setInterval((function(){var t=e.getPluginState().recordingLengthSeconds;e.setPluginState({recordingLengthSeconds:t+1})}),1e3)),this.setPluginState({isRecording:!0})}},{key:"stopRecording",value:function(){var e=this;return new Promise((function(t){e.recorder.addEventListener("stop",(function(){t()})),e.recorder.stop(),e.opts.showRecordingLength&&(clearInterval(e.recordingLengthTimer),e.setPluginState({recordingLengthSeconds:0}))})).then((function(){return e.setPluginState({isRecording:!1}),e.getVideo()})).then((function(t){try{e.capturedMediaFile=t,e.setPluginState({recordedVideo:URL.createObjectURL(t.data)}),W(e,q)[q]=!1}catch(n){n.isRestriction||e.uppy.log(n)}})).then((function(){e.recordingChunks=null,e.recorder=null}),(function(t){throw e.recordingChunks=null,e.recorder=null,t}))}},{key:"discardRecordedVideo",value:function(){this.setPluginState({recordedVideo:null}),this.opts.mirror&&(W(this,q)[q]=!0),this.capturedMediaFile=null}},{key:"submit",value:function(){try{this.capturedMediaFile&&this.uppy.addFile(this.capturedMediaFile)}catch(e){e.isRestriction||this.uppy.log(e,"error")}}},{key:"stop",value:(n=(0,i.A)(h.mark((function e(){var t,n,o=this;return h.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.stream&&(t=this.stream.getAudioTracks(),n=this.stream.getVideoTracks(),t.concat(n).forEach((function(e){return e.stop()}))),!this.recorder){e.next=4;break}return e.next=4,new Promise((function(e){o.recorder.addEventListener("stop",e,{once:!0}),o.recorder.stop(),o.opts.showRecordingLength&&clearInterval(o.recordingLengthTimer)}));case 4:this.recordingChunks=null,this.recorder=null,this.webcamActive=!1,this.stream=null,this.setPluginState({recordedVideo:null,isRecording:!1,recordingLengthSeconds:0});case 9:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getVideoElement",value:function(){return this.el.querySelector(".uppy-Webcam-video")}},{key:"oneTwoThreeSmile",value:function(){var e=this;return new Promise((function(t,n){var o=e.opts.countdown,i=setInterval((function(){if(!e.webcamActive)return clearInterval(i),e.captureInProgress=!1,n(new Error("Webcam is not active"));o>0?(e.uppy.info("".concat(o,"..."),"warning",800),o--):(clearInterval(i),e.uppy.info(e.i18n("smile"),"success",1500),setTimeout((function(){return t()}),1500))}),1e3)}))}},{key:"takeSnapshot",value:function(){var e=this;this.captureInProgress||(this.captureInProgress=!0,this.opts.onBeforeSnapshot().catch((function(t){var n="object"===(0,o.A)(t)?t.message:t;return e.uppy.info(n,"error",5e3),Promise.reject(new Error("onBeforeSnapshot: ".concat(n)))})).then((function(){return e.getImage()})).then((function(t){e.captureInProgress=!1;try{e.uppy.addFile(t)}catch(n){n.isRestriction||e.uppy.log(n)}}),(function(t){throw e.captureInProgress=!1,t})))}},{key:"getImage",value:function(){var e=this,t=this.getVideoElement();if(!t)return Promise.reject(new Error("No video element found, likely due to the Webcam tab being closed."));var n=t.videoWidth,o=t.videoHeight,i=document.createElement("canvas");i.width=n,i.height=o,i.getContext("2d").drawImage(t,0,0);var r=this.uppy.opts.restrictions,a=[];this.opts.preferredImageMimeType?a=[this.opts.preferredImageMimeType]:r.allowedFileTypes&&(a=r.allowedFileTypes.map(B).filter($));var s=a[0]||"image/jpeg",c=m(s)||"jpg",u="cam-".concat(Date.now(),".").concat(c);return function(e,t,n){return new Promise((function(o){e.toBlob(o,t,n)}))}(i,s).then((function(t){return{source:e.id,name:u,data:new Blob([t],{type:s}),type:s}}))}},{key:"getVideo",value:function(){var e=this.recordingChunks.find((function(e){var t;return(null==(t=e.type)?void 0:t.length)>0})).type,t=m(e);if(!t)return Promise.reject(new Error('Could not retrieve recording: Unsupported media type "'.concat(e,'"')));var n="webcam-".concat(Date.now(),".").concat(t),o=new Blob(this.recordingChunks,{type:e}),i={source:this.id,name:n,data:new Blob([o],{type:e}),type:e};return Promise.resolve(i)}},{key:"focus",value:function(){var e=this;this.opts.countdown&&setTimeout((function(){e.uppy.info(e.i18n("smile"),"success",1500)}),1e3)}},{key:"changeVideoSource",value:function(e){this.stop(),this.start({deviceId:e})}},{key:"updateVideoSources",value:function(){var e=this;this.mediaDevices.enumerateDevices().then((function(t){e.setPluginState({videoSources:t.filter((function(e){return"videoinput"===e.kind}))})}))}},{key:"render",value:function(){this.webcamActive||this.start();var e=this.getPluginState();return e.cameraReady&&e.hasCamera?(0,f.h)(M,V({},e,{onChangeVideoSource:this.changeVideoSource,onSnapshot:this.takeSnapshot,onStartRecording:this.startRecording,onStopRecording:this.stopRecording,onDiscardRecordedVideo:this.discardRecordedVideo,onSubmit:this.submit,onFocus:this.focus,onStop:this.stop,i18n:this.i18n,modes:this.opts.modes,showRecordingLength:this.opts.showRecordingLength,showVideoSourceDropdown:this.opts.showVideoSourceDropdown,supportsRecording:"function"==typeof MediaRecorder&&!!MediaRecorder.prototype&&"function"==typeof MediaRecorder.prototype.start,recording:e.isRecording,mirror:W(this,q)[q],src:this.stream})):(0,f.h)(j,{icon:w,i18n:this.i18n,hasCamera:e.hasCamera})}},{key:"install",value:function(){var e,t=this,n=this.opts,o=n.mobileNativeCamera,i=n.modes,r=n.facingMode,a=n.videoConstraints,s=this.opts.target;o&&s?null==(e=this.getTargetPlugin(s))||e.setOptions({showNativeVideoCameraButton:H(i,"video-only")||H(i,"video-audio"),showNativePhotoCameraButton:H(i,"picture"),nativeCameraFacingMode:(null==a?void 0:a.facingMode)||r}):(this.setPluginState({cameraReady:!1,recordingLengthSeconds:0}),s&&this.mount(s,this),this.mediaDevices&&(this.updateVideoSources(),this.mediaDevices.ondevicechange=function(){if(t.updateVideoSources(),t.stream){var e=!0,n=t.getPluginState(),o=n.videoSources,i=n.currentDeviceId;o.forEach((function(t){i===t.deviceId&&(e=!1)})),e&&(t.stop(),t.start())}}))}},{key:"uninstall",value:function(){this.stop(),this.unmount()}},{key:"onUnmount",value:function(){this.stop()}}]),t}(_.A);X.VERSION="3.3.6"}}]);