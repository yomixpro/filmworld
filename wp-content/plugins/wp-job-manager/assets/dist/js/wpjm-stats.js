!function(){"use strict";var n={};function t(n,t,e,r,o,a,i){try{var u=n[a](i),c=u.value}catch(n){return void e(n)}u.done?t(c):Promise.resolve(c).then(r,o)}function e(n){return function(){var e=this,r=arguments;return new Promise((function(o,a){var i=n.apply(e,r);function u(n){t(i,o,a,u,c,"next",n)}function c(n){t(i,o,a,u,c,"throw",n)}u(void 0)}))}}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};var r=window.regeneratorRuntime,o=n.n(r),a=window.wp.domReady,i=n.n(a),u=window.requestIdleCallback?function(n){return window.requestIdleCallback(n,{timeout:500})}:function(n){return setTimeout(n,100)},c="wpjm-stat-";function s(n){if(!n)return!0;var t=parseInt(n,10);return!!Number.isNaN(t)||t<Date.now()}function f(n){return n.filter((function(n){if(function(n){return!!n.unique_key}(n)){if(function(n){var t="".concat(c).concat(n.unique_key);return!s(window.localStorage[t])}(n))return!1;!function(n){var t="".concat(c).concat(n.unique_key),e=Date.now()+864e5;window.localStorage[t]=e}(n)}return!0}))}function l(n){return new Promise((function(t){var e=document.querySelector(n);if(e)return t(e);var r=new MutationObserver((function(){(e=document.querySelector(n))&&(r.disconnect(),t(e))}));r.observe(document.documentElement,{childList:!0,subtree:!0})}))}function d(n){var t={},e=[];function r(){var n=e.map((function(n){return t[n.post_id]=!0,n}));e=[],window.WPJMStats.log(n)}var o,a,i=(o=r,1e3,function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];clearTimeout(a),a=setTimeout((function(){o.apply(void 0,t)}),1e3)});return{queueLogStat:function(o){t[o]||(e.push({name:n,post_id:o}),e.length>=10?r():i())}}}function v(n,t){var e={},r=new IntersectionObserver((function(n){n.forEach((function(n){if(n.isIntersecting&&n.intersectionRatio>.99){var o=n.target,a=function(n){var t;return+(null===(t=n.className.match(/\bpost-(\d+)\b/))||void 0===t?void 0:t[1])||0}(o);a>0&&!e[a]&&(e[a]=!0,t(a)),r.unobserve(o)}}))}),{root:null,rootMargin:"0px",threshold:1});return r}function m(n,t){var e=t.selector,r=t.onAdded,o=t.onRemoved;new MutationObserver((function(n){n.forEach((function(n){n.removedNodes.forEach((function(n){var t;null!==(t=n.matches)&&void 0!==t&&t.call(n,e)&&o(n)})),n.addedNodes.forEach((function(n){var t;null!==(t=n.matches)&&void 0!==t&&t.call(n,e)&&r(n)}))}))})).observe(n,{childList:!0})}function p(){return(p=e(o().mark((function n(t){var e,r,a,i,u;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=t.args,r=d(t.name),a=r.queueLogStat,n.next=4,l(e.container);case 4:i=n.sent,u=v(0,a),i.querySelectorAll(e.item).forEach((function(n){return u.observe(n)})),m(i,{selector:e.item,onAdded:function(n){return u.observe(n)},onRemoved:function(n){return u.unobserve(n)}});case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var w={stats:[],actions:[],init:function(n){w.stats=n,n.forEach((function(n){var t,e;null===(t=(e=w.types)[n.type])||void 0===t||t.call(e,n)})),w.doAction("page-load"),u((function(){for(var n=0;n<localStorage.length;n++){var t=localStorage.key(n);t.startsWith(c)&&s(localStorage.getItem(t))&&localStorage.removeItem(t)}}))},doAction:function(n){var t=w.actions[n];t&&w.log(t)},types:{action:function(n){var t=n.action;w.actions[t]||(w.actions[t]=[]),w.actions[t].push(n)},domEvent:function(n){var t=n.args;if(t.element&&t.event){var e=document.querySelector(t.element),r=n.action?function(){return w.doAction(n.action)}:function(){return w.log(n)};null==e||e.addEventListener(t.event,r)}},impression:function(_x){return p.apply(this,arguments)}},log:function(n){return e(o().mark((function t(){var e,r,a,i,u,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.name&&(n=[n]),e=window.job_manager_stats,r=e.ajaxUrl,a=e.ajaxNonce,i=e.postId,(n=f(n)).length){t.next=5;break}return t.abrupt("return",!1);case 5:return u=n.map((function(n){return["name","group","post_id"].reduce((function(t,e){return n[e]&&(t[e]=n[e]),t}),{})})),c=new URLSearchParams({_ajax_nonce:a,post_id:i,action:"job_manager_log_stat",stats:JSON.stringify(u)}),t.abrupt("return",fetch(r,{method:"POST",credentials:"same-origin",body:c}));case 8:case"end":return t.stop()}}),t)})))()}};window.WPJMStats=w,i()((function(){u((function(){var n=window.job_manager_stats.stats;w.init(n)}))}))}();