"use strict";function changeHeight(e){var t=e.target.value;0==(t.match(/\n/g)||[]).length?e.target.style.height="2em":(13==e.keyCode&&e.shiftKey||8==e.keyCode?(e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"):13==e.keyCode&&(""!=t.trim()?e.target.closest("form.socialv-comment-form").querySelector("button.ac_form_submit").click():e.target.value=""),e.stopPropagation())}function swiperSlider(e){e.forEach(function(t){var i={spaceBetween:16,pagination:{el:".swiper-pagination",dynamicBullets:!0,clickable:!0}},a=new Swiper(t,i);document.addEventListener("theme_scheme_direction",function(e){a.destroy(!0,!0),setTimeout(function(){a=new Swiper(t,i)},500)})})}function socialv_legacy_theme_hide_comments(){var t,i,a,e,s=jQuery("div.activity-comments-list");if(!s.length)return!1;s.each(function(){jQuery(this).children("ul").children("li").length<2||(e=jQuery(this),t=e.parents("#activity-stream > li"),i=jQuery(this).children("ul").children("li"),a=" ",jQuery("#"+t.attr("id")+' li[id*="acomment-"]').length&&(a=jQuery("#"+t.attr("id")+' li[id*="acomment-"]').length),i.each(function(e){e<i.length-2&&(jQuery(this).hide(),e||jQuery(this).closest(".activity-comments-list").prev().before('<div class="show-all-comments"><a href="#'+t.attr("id")+'/show-all/">'+BP_DTheme.show_x_comments.replace("%d",a)+"</a></div>"))}))})}function domLoadingComplete(){var e=document.querySelectorAll(".socialv-swiper-slider:not(.swiper-initialized)");0<e.length&&swiperSlider(e),document.getElementById("activity-stream")&&document.getElementById("activity-stream").addEventListener("DOMNodeInserted",function(e){"LI"==e.target.tagName&&null!=e.target.querySelector(".activity-content .swiper")&&0<(e=e.target.querySelectorAll(".activity-content .swiper")).length&&swiperSlider(e)}),document.querySelector(".activity-comments-list ul.activity-comments")&&document.querySelector(".activity-comments-list ul.activity-comments").addEventListener("DOMNodeRemoved",function(e){var t,i;"LI"==e.target.tagName&&e.target.closest(".activity-comments-list").parentElement.querySelector("div.show-all-comments a")&&(t=e.target.parentElement.querySelectorAll("li").length-1,i=e.target.closest(".activity-comments-list").parentElement.querySelector("div.show-all-comments a"),t<3?(i.remove(),[].forEach.call(e.target.parentElement.querySelectorAll("li"),function(e){e.removeAttribute("style")})):i.textContent=BP_DTheme.show_x_comments.replace("%d",t))}),document.addEventListener("click",function(e){e.target.hash&&"#newest"==e.target.hash&&document.getElementById("buddypress")&&(document.body.scrollTop=document.getElementById("buddypress").offsetTop,document.documentElement.scrollTop=document.getElementById("buddypress").offsetTop),null!=(document.querySelector(".show-all-comments")?document.querySelector(".show-all-comments"):null)&&e.target.parentElement.classList.contains("show-all-comments")&&(e.target.parentElement.style.display="none",[].forEach.call(e.target.closest(".show-all-comments").parentElement.querySelectorAll("ul.activity-comments li"),function(e){e.removeAttribute("style")}))})}function LoadbpGiphy(){0<jQuery(".bp-giphy-icon").length&&jQuery(document).on("click",".bp-giphy-icon",function(e){var t=jQuery(this).next();jQuery(t).addClass("show"),0!=jQuery(".bp-giphy-media-search-dropdown").not(t).length&&jQuery(".bp-giphy-media-search-dropdown").not(t).each(function(e,t){jQuery(t).removeClass("show")})})}document.addEventListener("readystatechange",function(e){"complete"==document.readyState&&domLoadingComplete()}),function(c){c(document).ready(function(){c(document).on("click",".socialv-acomment-reply",function(e){e.preventDefault();var e=c(this),t="#"+e.attr("comment-id"),i=c(t);c(t).remove(),c(".socialv-acomment-reply").not(e).removeClass("active"),e.hasClass("active")&&(e.removeClass("active"),i.is(":hidden"))||i.hide(),e.hasClass("main-comment")?e.closest(".socialv-activity-parent").find(".activity-comments.socialv-form").prepend(i):e.closest(".comment-container-main").after(i),e.addClass("active"),i.slideDown(),c("html, body").stop().animate({scrollTop:c(t).offset().top-100},"500"),i.find("textarea.ac-input")[0].addEventListener("keyup",changeHeight,!1),jQuery("body").hasClass("buddypress-giphy-active")&&(e=c(this).attr("id").split("-"),0===c("#activity-"+e[2]+" .activity-comments #ac-form-"+e[2]+" .ac-reply-content .bp-giphy-comment-html-container").length)&&c("#activity-"+e[2]+" .activity-comments #ac-form-"+e[2]+" .ac-textarea").after('<div class="bp-giphy-comment-html-container bp-giphy-html-container"><div class="bp-giphy-media-search"><div class="bp-giphy-icon" title="'+bpgp_data.add_gif_text+'"><i class="wb-icons wb-icon-gif"></i></div><div class="bp-giphy-media-search-dropdown"></div></div></div>')}),c("body").hasClass("bp-legacy buddypress-giphy-active")&&c("div.activity").on("click",function(e){var e=c(e.target);(e.hasClass("socialv-acomment-reply")||e.parent().hasClass("socialv-acomment-reply"))&&(e=(e=e.parent().hasClass("socialv-acomment-reply")?e.parent():e).attr("id").split("-"),0===c("#activity-"+e[2]+" .activity-comments #ac-form-"+e[2]+" .ac-reply-content .bp-giphy-comment-html-container").length)&&c("#activity-"+e[2]+" .activity-comments #ac-form-"+e[2]+" .ac-textarea").after('<div class="bp-giphy-comment-html-container bp-giphy-html-container"><div class="bp-giphy-media-search"><div class="bp-giphy-icon" data-bs-toggle="tooltip" data-bs-placement="top" title="" data-bs-original-title="'+bpgp_data.add_gif_text+'"><i class="wb-icons wb-icon-gif"></i></div><div class="bp-giphy-media-search-dropdown"></div></div></div>')}),c(document).on("click",".socialv-get-liked-users",function(e){e.preventDefault();e=c(this).data("id");return c.ajax({type:"GET",url:ajaxurl,data:{action:"socialv_activity_liked_users",id:e},success:function(e){e&&(c("#liked-users-modal .modal-body").html(e),c("#liked-users-modal").modal("show"))}}),!1}),c(".select-media-checkbox.multi").on("change",function(e){var t,i=c(".select-media-checkbox.single");void 0===e.originalEvent?(t=!0,i.each(function(){this.checked?c(this).closest(".socialv-media-container").addClass("socialv-selected"):c(this).closest(".socialv-media-container").removeClass("socialv-selected"),t=t&&this.checked}),this.checked=t):(i.prop("checked",this.checked),i.closest(".socialv-media-container").removeClass("socialv-selected"),this.checked&&i.closest(".socialv-media-container").addClass("socialv-selected"))}),c(".select-media-checkbox.single").on("change",function(){c(".select-media-checkbox.multi").trigger("change")}),c(".socialv-delete-media").stop().click(function(e){var i,a,s;if(e.preventDefault(),confirm(socialv_global_script.alert_media))return i=c(this),e="media",a="",(s=!!i.hasClass("multi-delete"))?c(".select-media-checkbox.single[type=checkbox]:checked").each(function(){a+=""==a?c(this).val():","+c(this).val()}):(a=i.data("id"),e="gallery"),c.ajax({type:"GET",dataType:"json",url:ajaxurl,data:{action:"user_delete_media",id:a,type:e},success:function(e){var t;s&&!0===e.status?(t=a.split(","),c.each(t,function(e){c(".select-media-checkbox.single[value="+t[e]+"]").closest(".mpp-media").remove()})):i.closest(".mpp-item").remove()}}),!1}),0<jQuery("div.activity-comments-list").length&&socialv_legacy_theme_hide_comments();var i=c(window),t=(i.scroll(function(){ScrollGallery();var e,t=c(".load-more:visible");t.get(0)&&!t.data("bpaa-autoloaded")&&(e=t.offset().top-3e3,i.scrollTop()+i.height()>e)&&(t.data("bpaa-autoloaded",1),t.find("a").trigger("click"))}),c(void 0));if(t.parent().hasClass("load-more"))return bp_ajax_request&&bp_ajax_request.abort(),c("#buddypress li.load-more").addClass("loading"),oldest_page=activity_oldestpage+1,just_posted=[],c(".activity-list li.just-posted").each(function(){just_posted.push(c(this).attr("id").replace("activity-",""))}),load_more_args={action:"activity_get_older_updates",cookie:bp_get_cookies(),page:oldest_page,exclude_just_posted:just_posted.join(",")},(load_more_search=bp_get_querystring("s"))&&(load_more_args.search_terms=load_more_search),bp_ajax_request=jq.post(ajaxurl,load_more_args,function(e){c("#buddypress li.load-more").removeClass("loading"),activity_oldestpage=oldest_page;e=c(e.contents);c("#buddypress ul.activity-list").append(e),t.parent().hide(),bp_legacy_theme_hide_comments(e),window.instgrm&&window.instgrm.Embeds.process()},"json"),!1;LoadbpGiphy(),c("div.activity").on("click",function(e){var i,a,t,s=c(e.target);if(s.hasClass("socialv_delete-activity"))return e=(i=s.parents("div.activity ul li")).attr("id").substr(9,i.attr("id").length),t=s.attr("href").split("_wpnonce="),a=i.prop("class").match(/date-recorded-([0-9]+)/),t=t[1],s.addClass("loading"),confirm(socialv_global_script.alert_media)&&c.post(ajaxurl,{action:"delete_activity",cookie:bp_get_cookies(),id:e,_wpnonce:t},function(e){var t;e[0]+e[1]==="-1"?(i.prepend(e.substr(2,e.length)),i.children("#message").hide().fadeIn(300)):(i.slideUp(300),e=i.closest(".activity-item"),t=s.data("success"),t=jQuery('<div id="template-notices" role="alert" aria-atomic="true"><div id="message" class="bp-template-notice updated"><p>'+t+"</p></div></div>"),e.after(t),setTimeout(function(){var e=jQuery("#message");0<e.length&&e.parent().remove()},5e3),a&&activity_last_recorded===a[1]&&(newest_activities="",activity_last_recorded=0))}),!1})})}(jQuery),document.addEventListener("click",function(e){var t,i,a,s,c,o,n;if(e.target.classList.contains("socialv-user-activity-btn"))return e.preventDefault(),t=e.target.getAttribute("data-id"),i=e.target.getAttribute("data-unpin"),a=e.target.getAttribute("data-pin"),s=e.target,e="_socialv_activity_liked_users",c=s.classList.contains("has-socialv-pin"),o=s.classList.contains("has-socialv-post"),s.classList.add("adding"),s.innerHTML='<i class="icon-loader-circle"></i>',o&&(e="_socialv_posts_liked_users"),c&&(e="_socialv_user_pinned_activity"),(n=new XMLHttpRequest).open("GET",ajaxurl+"?action=socialv_user_activity_callback&id="+t+"&meta_key="+e,!0),n.setRequestHeader("Content-Type","application/json"),n.onload=function(){var e,t;200===n.status&&(e=JSON.parse(n.responseText).data,c?e&&!0===e.status?(s.classList.add("adding"),s.innerHTML=i,s.setAttribute("data-unpin",a),s.classList.add("added")):(s.innerHTML=a,s.setAttribute("data-unpin",i),s.classList.remove("added")):e?(s.classList.remove("adding"),t=s.innerHTML,s.innerHTML='<i class="iconly-Heart icbo"></i>'+t+(e="<span>"+e+"</span>"),s.classList.add("liked"),s.classList.contains("added")?(s.innerHTML='<i class="iconly-Heart icli"></i>'+t+e,s.classList.remove("added")):(s.innerHTML='<i class="iconly-Heart icbo"></i>'+t+e,s.classList.add("added"))):(s.classList.remove("adding"),s.classList.remove("liked"),s.innerHTML='<i class="iconly-Heart icli"></i>'+s.innerHTML)),s.innerHTML=s.innerHTML.replace('<i class="icon-loader-circle"></i>',"")},n.send(),!1}),document.addEventListener("DOMContentLoaded",function(){document.querySelector("body").addEventListener("click",function(e){var t,i,a,s;e.target.matches(".hide-post-btn")&&(e.preventDefault(),t=e.target.closest(".activity-item"),i=e.target.dataset.activity_id,a=e.target.dataset.id,s=e.target.dataset.type,fetch(ajaxurl,{method:"POST",body:new URLSearchParams({action:"hide_activity_post",activity_id:i,user_id:a,data_type:s})}).then(function(e){return e.json()}).then(function(e){"hide"===s?(t.querySelector(".socialv_activity_inner").style.display="none",t.querySelector(".undo_activity_post").style.display="block",!0===e.success&&(t.style.display="block")):"undo"===s&&(t.style.display="block",t.querySelector(".socialv_activity_inner").style.display="block",t.querySelector(".undo_activity_post").style.display="none")}))})});